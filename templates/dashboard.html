{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2 class="text-center mb-4">Welcome, {{ name }}!</h2>
    <h3 class="mb-3">Upload Your Resume</h3>
    <form method="POST" action="{{ url_for('dashboard') }}" enctype="multipart/form-data">
    <div class="mb-3">
        <label for="resume" class="form-label">Upload your resume (PDF):</label>
        <input type="file" class="form-control" name="resume" accept="application/pdf" required>
    </div>
    <button type="submit" class="btn btn-primary">Upload and Analyze Resume</button>
    </form>

    {% if feedback %}
    <div class="mt-4">
        <h3>AI Feedback</h3>
        <div class="card">
            <div class="card-body">
                <p><strong>Score:</strong> {{ feedback.score }}</p>
                <p><strong>Feedback:</strong> {{ feedback.feedback }}</p>
                <p><strong>Best Matching Job Title:</strong> {{ feedback.best_match }}</p>
                <p><strong>ATS Compatibility:</strong> {{ feedback.ats_compatibility }}</p>
                <p><strong>Suggestions:</strong> {{ feedback.suggestions }}</p>
            </div>
        </div>
    </div>
    {% endif %}

  <h3 class="mt-5 mb-3">Corrected Version of Resumes</h3>
{% if resumes %}
    <ul class="list-group">
        {% for resume in resumes %}
            <li class="list-group-item">
                <div class="formatted-resume">
                    {{ resume.resume | safe }}
                </div>
                <!-- Add a delete button with confirmation -->
                <form method="POST" action="{{ url_for('delete_resume', resume_id=resume.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this resume?');">
                    <button type="submit" class="btn btn-danger btn-sm mt-2">Delete</button>
                </form>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p>No resumes uploaded yet.</p>
{% endif %}
    <div class="mt-4">
        <a href="{{ url_for('logout') }}" class="btn btn-danger">Logout</a>
    </div>
</div>
{% endblock %}